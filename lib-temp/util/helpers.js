import Vue from 'vue';
export function createSimpleFunctional(c, el = 'div', name) {
    return Vue.extend({
        name: name || c.replace(/__/g, '-'),
        functional: true,
        render(h, { data, children }) {
            data.staticClass = (`${c} ${data.staticClass || ''}`).trim();
            return h(el, data, children);
        },
    });
}
export function directiveConfig(binding, defaults = {}) {
    return {
        ...defaults,
        ...binding.modifiers,
        value: binding.arg,
        ...(binding.value || {}),
    };
}
export function addOnceEventListener(el, eventName, cb, options = false) {
    var once = (event) => {
        cb(event);
        el.removeEventListener(eventName, once, options);
    };
    el.addEventListener(eventName, once, options);
}
let passiveSupported = false;
try {
    if (typeof window !== 'undefined') {
        const testListenerOpts = Object.defineProperty({}, 'passive', {
            get: () => {
                passiveSupported = true;
            },
        });
        window.addEventListener('testListener', testListenerOpts, testListenerOpts);
        window.removeEventListener('testListener', testListenerOpts, testListenerOpts);
    }
}
catch (e) {
    console.warn(e);
}
export { passiveSupported };
export function addPassiveEventListener(el, event, cb, options) {
    el.addEventListener(event, cb, passiveSupported ? options : false);
}
export function getNestedValue(obj, path, fallback) {
    const last = path.length - 1;
    if (last < 0)
        return obj === undefined ? fallback : obj;
    for (let i = 0; i < last; i++) {
        if (obj == null) {
            return fallback;
        }
        obj = obj[path[i]];
    }
    if (obj == null)
        return fallback;
    return obj[path[last]] === undefined ? fallback : obj[path[last]];
}
export function deepEqual(a, b) {
    if (a === b)
        return true;
    if (a instanceof Date && b instanceof Date) {
        // If the values are Date, they were convert to timestamp with getTime and compare it
        if (a.getTime() !== b.getTime())
            return false;
    }
    if (a !== Object(a) || b !== Object(b)) {
        // If the values aren't objects, they were already checked for equality
        return false;
    }
    const props = Object.keys(a);
    if (props.length !== Object.keys(b).length) {
        // Different number of props, don't bother to check
        return false;
    }
    return props.every(p => deepEqual(a[p], b[p]));
}
export function getObjectValueByPath(obj, path, fallback) {
    // credit: http://stackoverflow.com/questions/6491463/accessing-nested-javascript-objects-with-string-key#comment55278413_6491621
    if (obj == null || !path || typeof path !== 'string')
        return fallback;
    if (obj[path] !== undefined)
        return obj[path];
    path = path.replace(/\[(\w+)\]/g, '.$1'); // convert indexes to properties
    path = path.replace(/^\./, ''); // strip a leading dot
    return getNestedValue(obj, path.split('.'), fallback);
}
export function getPropertyFromItem(item, property, fallback) {
    if (property == null)
        return item === undefined ? fallback : item;
    if (item !== Object(item))
        return fallback === undefined ? item : fallback;
    if (typeof property === 'string')
        return getObjectValueByPath(item, property, fallback);
    if (Array.isArray(property))
        return getNestedValue(item, property, fallback);
    if (typeof property !== 'function')
        return fallback;
    const value = property(item, fallback);
    return typeof value === 'undefined' ? fallback : value;
}
export function createRange(length) {
    return Array.from({ length }, (v, k) => k);
}
export function getZIndex(el) {
    if (!el || el.nodeType !== Node.ELEMENT_NODE)
        return 0;
    const index = +window.getComputedStyle(el).getPropertyValue('z-index');
    if (!index)
        return getZIndex(el.parentNode);
    return index;
}
const tagsToReplace = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
};
export function escapeHTML(str) {
    return str.replace(/[&<>]/g, tag => tagsToReplace[tag] || tag);
}
export function filterObjectOnKeys(obj, keys) {
    const filtered = {};
    for (let i = 0; i < keys.length; i++) {
        const key = keys[i];
        if (typeof obj[key] !== 'undefined') {
            filtered[key] = obj[key];
        }
    }
    return filtered;
}
export function convertToUnit(str, unit = 'px') {
    if (str == null || str === '') {
        return undefined;
    }
    else if (isNaN(+str)) {
        return String(str);
    }
    else {
        return `${Number(str)}${unit}`;
    }
}
export function kebabCase(str) {
    return (str || '').replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();
}
export function isObject(obj) {
    return obj !== null && typeof obj === 'object';
}
// KeyboardEvent.keyCode aliases
export const keyCodes = Object.freeze({
    enter: 13,
    tab: 9,
    delete: 46,
    esc: 27,
    space: 32,
    up: 38,
    down: 40,
    left: 37,
    right: 39,
    end: 35,
    home: 36,
    del: 46,
    backspace: 8,
    insert: 45,
    pageup: 33,
    pagedown: 34,
});
// This remaps internal names like '$cancel' or '$vuetify.icons.cancel'
// to the current name or component for that icon.
export function remapInternalIcon(vm, iconName) {
    if (!iconName.startsWith('$')) {
        return iconName;
    }
    // Get the target icon name
    const iconPath = `$vuetify.icons.values.${iconName.split('$').pop().split('.').pop()}`;
    // Now look up icon indirection name,
    // e.g. '$vuetify.icons.values.cancel'
    return getObjectValueByPath(vm, iconPath, iconName);
}
export function keys(o) {
    return Object.keys(o);
}
/**
 * Camelize a hyphen-delimited string.
 */
const camelizeRE = /-(\w)/g;
export const camelize = (str) => {
    return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : '');
};
/**
 * Returns the set difference of B and A, i.e. the set of elements in B but not in A
 */
export function arrayDiff(a, b) {
    const diff = [];
    for (let i = 0; i < b.length; i++) {
        if (a.indexOf(b[i]) < 0)
            diff.push(b[i]);
    }
    return diff;
}
/**
 * Makes the first character of a string uppercase
 */
export function upperFirst(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}
export function groupItems(items, groupBy, groupDesc) {
    const key = groupBy[0];
    const groups = [];
    let current = null;
    for (var i = 0; i < items.length; i++) {
        const item = items[i];
        const val = getObjectValueByPath(item, key);
        if (current !== val) {
            current = val;
            groups.push({
                name: val,
                items: [],
            });
        }
        groups[groups.length - 1].items.push(item);
    }
    return groups;
}
export function wrapInArray(v) { return v != null ? Array.isArray(v) ? v : [v] : []; }
export function sortItems(items, sortBy, sortDesc, locale, customSorters) {
    if (sortBy === null || !sortBy.length)
        return items;
    const stringCollator = new Intl.Collator(locale, { sensitivity: 'accent', usage: 'sort' });
    return items.sort((a, b) => {
        for (let i = 0; i < sortBy.length; i++) {
            const sortKey = sortBy[i];
            let sortA = getObjectValueByPath(a, sortKey);
            let sortB = getObjectValueByPath(b, sortKey);
            if (sortDesc[i]) {
                [sortA, sortB] = [sortB, sortA];
            }
            if (customSorters && customSorters[sortKey]) {
                const customResult = customSorters[sortKey](sortA, sortB);
                if (!customResult)
                    continue;
                return customResult;
            }
            // Check if both cannot be evaluated
            if (sortA === null && sortB === null) {
                continue;
            }
            [sortA, sortB] = [sortA, sortB].map(s => (s || '').toString().toLocaleLowerCase());
            if (sortA !== sortB) {
                if (!isNaN(sortA) && !isNaN(sortB))
                    return Number(sortA) - Number(sortB);
                return stringCollator.compare(sortA, sortB);
            }
        }
        return 0;
    });
}
export function defaultFilter(value, search, item) {
    return value != null &&
        search != null &&
        typeof value !== 'boolean' &&
        value.toString().toLocaleLowerCase().indexOf(search.toLocaleLowerCase()) !== -1;
}
export function searchItems(items, search) {
    if (!search)
        return items;
    search = search.toString().toLowerCase();
    if (search.trim() === '')
        return items;
    return items.filter(item => Object.keys(item).some(key => defaultFilter(getObjectValueByPath(item, key), search, item)));
}
/**
 * Returns:
 *  - 'normal' for old style slots - `<template slot="default">`
 *  - 'scoped' for old style scoped slots (`<template slot="default" slot-scope="data">`) or bound v-slot (`#default="data"`)
 *  - 'v-slot' for unbound v-slot (`#default`) - only if the third param is true, otherwise counts as scoped
 */
export function getSlotType(vm, name, split) {
    if (vm.$slots[name] && vm.$scopedSlots[name] && vm.$scopedSlots[name].name) {
        return split ? 'v-slot' : 'scoped';
    }
    if (vm.$slots[name])
        return 'normal';
    if (vm.$scopedSlots[name])
        return 'scoped';
}
export function debounce(fn, delay) {
    let timeoutId = 0;
    return (...args) => {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => fn(...args), delay);
    };
}
export function getPrefixedScopedSlots(prefix, scopedSlots) {
    return Object.keys(scopedSlots).filter(k => k.startsWith(prefix)).reduce((obj, k) => {
        obj[k.replace(prefix, '')] = scopedSlots[k];
        return obj;
    }, {});
}
export function getSlot(vm, name = 'default', data, optional = false) {
    if (vm.$scopedSlots[name]) {
        return vm.$scopedSlots[name](data instanceof Function ? data() : data);
    }
    else if (vm.$slots[name] && (!data || optional)) {
        return vm.$slots[name];
    }
    return undefined;
}
export function clamp(value, min = 0, max = 1) {
    return Math.max(min, Math.min(max, value));
}
export function padEnd(str, length, char = '0') {
    return str + char.repeat(Math.max(0, length - str.length));
}
export function chunk(str, size = 1) {
    const chunked = [];
    let index = 0;
    while (index < str.length) {
        chunked.push(str.substr(index, size));
        index += size;
    }
    return chunked;
}
export function humanReadableFileSize(bytes, binary = false) {
    const base = binary ? 1024 : 1000;
    if (bytes < base) {
        return `${bytes} B`;
    }
    const prefix = binary ? ['Ki', 'Mi', 'Gi'] : ['k', 'M', 'G'];
    let unit = -1;
    while (Math.abs(bytes) >= base && unit < prefix.length - 1) {
        bytes /= base;
        ++unit;
    }
    return `${bytes.toFixed(1)} ${prefix[unit]}B`;
}
export function camelizeObjectKeys(obj) {
    if (!obj)
        return {};
    return Object.keys(obj).reduce((o, key) => {
        o[camelize(key)] = obj[key];
        return o;
    }, {});
}
export function mergeDeep(source = {}, target = {}) {
    for (const key in target) {
        const sourceProperty = source[key];
        const targetProperty = target[key];
        // Only continue deep merging if
        // both properties are objects
        if (isObject(sourceProperty) &&
            isObject(targetProperty)) {
            source[key] = mergeDeep(sourceProperty, targetProperty);
            continue;
        }
        source[key] = targetProperty;
    }
    return source;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2hlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxHQUFHLE1BQU0sS0FBSyxDQUFBO0FBS3JCLE1BQU0sVUFBVSxzQkFBc0IsQ0FDcEMsQ0FBUyxFQUNULEVBQUUsR0FBRyxLQUFLLEVBQ1YsSUFBYTtJQUViLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQztRQUNoQixJQUFJLEVBQUUsSUFBSSxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQztRQUVuQyxVQUFVLEVBQUUsSUFBSTtRQUVoQixNQUFNLENBQUUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtZQUMzQixJQUFJLENBQUMsV0FBVyxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFBO1lBRTVELE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUE7UUFDOUIsQ0FBQztLQUNGLENBQUMsQ0FBQTtBQUNKLENBQUM7QUFHRCxNQUFNLFVBQVUsZUFBZSxDQUFFLE9BQXNCLEVBQUUsUUFBUSxHQUFHLEVBQUU7SUFDcEUsT0FBTztRQUNMLEdBQUcsUUFBUTtRQUNYLEdBQUcsT0FBTyxDQUFDLFNBQVM7UUFDcEIsS0FBSyxFQUFFLE9BQU8sQ0FBQyxHQUFHO1FBQ2xCLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxJQUFJLEVBQUUsQ0FBQztLQUN6QixDQUFBO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxvQkFBb0IsQ0FDbEMsRUFBZSxFQUNmLFNBQWlCLEVBQ2pCLEVBQTBCLEVBQzFCLFVBQTZDLEtBQUs7SUFFbEQsSUFBSSxJQUFJLEdBQUcsQ0FBQyxLQUFZLEVBQUUsRUFBRTtRQUMxQixFQUFFLENBQUMsS0FB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LEdBQUcsQ0FBQTtBQUMvQyxDQUFDO0FBRUQsTUFBTSxVQUFVLGtCQUFrQixDQUFFLEdBQTJDO0lBQzdFLElBQUksQ0FBQyxHQUFHO1FBQUUsT0FBTyxFQUFFLENBQUE7SUFFbkIsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQU0sRUFBRSxHQUFXLEVBQUUsRUFBRTtRQUNyRCxDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQzNCLE9BQU8sQ0FBQyxDQUFBO0lBQ1YsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFBO0FBQ1IsQ0FBQztBQUVELE1BQU0sVUFBVSxTQUFTLENBQ3ZCLFNBQTBCLEVBQUUsRUFDNUIsU0FBMEIsRUFBRTtJQUU1QixLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sRUFBRTtRQUN4QixNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDbEMsTUFBTSxjQUFjLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBRWxDLGdDQUFnQztRQUNoQyw4QkFBOEI7UUFDOUIsSUFDRSxRQUFRLENBQUMsY0FBYyxDQUFDO1lBQ3hCLFFBQVEsQ0FBQyxjQUFjLENBQUMsRUFDeEI7WUFDQSxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsU0FBUyxDQUFDLGNBQWMsRUFBRSxjQUFjLENBQUMsQ0FBQTtZQUV2RCxTQUFRO1NBQ1Q7UUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsY0FBYyxDQUFBO0tBQzdCO0lBRUQsT0FBTyxNQUFNLENBQUE7QUFDZixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZ1ZSBmcm9tICd2dWUnXG5pbXBvcnQgeyBWTm9kZSwgVk5vZGVEaXJlY3RpdmUgfSBmcm9tICd2dWUvdHlwZXMnXG5pbXBvcnQgeyBWdWV0aWZ5SWNvbiB9IGZyb20gJ3Z1ZXRpZnkvdHlwZXMvc2VydmljZXMvaWNvbnMnXG5pbXBvcnQgeyBEYXRhVGFibGVDb21wYXJlRnVuY3Rpb24sIFNlbGVjdEl0ZW1LZXksIEl0ZW1Hcm91cCB9IGZyb20gJ3R5cGVzJ1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2ltcGxlRnVuY3Rpb25hbCAoXG4gIGM6IHN0cmluZyxcbiAgZWwgPSAnZGl2JyxcbiAgbmFtZT86IHN0cmluZ1xuKSB7XG4gIHJldHVybiBWdWUuZXh0ZW5kKHtcbiAgICBuYW1lOiBuYW1lIHx8IGMucmVwbGFjZSgvX18vZywgJy0nKSxcblxuICAgIGZ1bmN0aW9uYWw6IHRydWUsXG5cbiAgICByZW5kZXIgKGgsIHsgZGF0YSwgY2hpbGRyZW4gfSk6IFZOb2RlIHtcbiAgICAgIGRhdGEuc3RhdGljQ2xhc3MgPSAoYCR7Y30gJHtkYXRhLnN0YXRpY0NsYXNzIHx8ICcnfWApLnRyaW0oKVxuXG4gICAgICByZXR1cm4gaChlbCwgZGF0YSwgY2hpbGRyZW4pXG4gICAgfSxcbiAgfSlcbn1cblxuZXhwb3J0IHR5cGUgQmluZGluZ0NvbmZpZyA9IFBpY2s8Vk5vZGVEaXJlY3RpdmUsICdhcmcnIHwgJ21vZGlmaWVycycgfCAndmFsdWUnPlxuZXhwb3J0IGZ1bmN0aW9uIGRpcmVjdGl2ZUNvbmZpZyAoYmluZGluZzogQmluZGluZ0NvbmZpZywgZGVmYXVsdHMgPSB7fSk6IFZOb2RlRGlyZWN0aXZlIHtcbiAgcmV0dXJuIHtcbiAgICAuLi5kZWZhdWx0cyxcbiAgICAuLi5iaW5kaW5nLm1vZGlmaWVycyxcbiAgICB2YWx1ZTogYmluZGluZy5hcmcsXG4gICAgLi4uKGJpbmRpbmcudmFsdWUgfHwge30pLFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRPbmNlRXZlbnRMaXN0ZW5lciAoXG4gIGVsOiBFdmVudFRhcmdldCxcbiAgZXZlbnROYW1lOiBzdHJpbmcsXG4gIGNiOiAoZXZlbnQ6IEV2ZW50KSA9PiB2b2lkLFxuICBvcHRpb25zOiBib29sZWFuIHwgQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnMgPSBmYWxzZVxuKTogdm9pZCB7XG4gIHZhciBvbmNlID0gKGV2ZW50OiBFdmVudCkgPT4ge1xuICAgIGNiKGV2ZW50KVxuICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBvbmNlLCBvcHRpb25zKVxuICB9XG5cbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIG9uY2UsIG9wdGlvbnMpXG59XG5cbmxldCBwYXNzaXZlU3VwcG9ydGVkID0gZmFsc2VcbnRyeSB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGNvbnN0IHRlc3RMaXN0ZW5lck9wdHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdwYXNzaXZlJywge1xuICAgICAgZ2V0OiAoKSA9PiB7XG4gICAgICAgIHBhc3NpdmVTdXBwb3J0ZWQgPSB0cnVlXG4gICAgICB9LFxuICAgIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndGVzdExpc3RlbmVyJywgdGVzdExpc3RlbmVyT3B0cywgdGVzdExpc3RlbmVyT3B0cylcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdExpc3RlbmVyJywgdGVzdExpc3RlbmVyT3B0cywgdGVzdExpc3RlbmVyT3B0cylcbiAgfVxufSBjYXRjaCAoZSkgeyBjb25zb2xlLndhcm4oZSkgfVxuZXhwb3J0IHsgcGFzc2l2ZVN1cHBvcnRlZCB9XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRQYXNzaXZlRXZlbnRMaXN0ZW5lciAoXG4gIGVsOiBFdmVudFRhcmdldCxcbiAgZXZlbnQ6IHN0cmluZyxcbiAgY2I6IEV2ZW50SGFuZGxlck5vbk51bGwgfCAoKCkgPT4gdm9pZCksXG4gIG9wdGlvbnM6IHt9XG4pOiB2b2lkIHtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgY2IsIHBhc3NpdmVTdXBwb3J0ZWQgPyBvcHRpb25zIDogZmFsc2UpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXROZXN0ZWRWYWx1ZSAob2JqOiBhbnksIHBhdGg6IChzdHJpbmcgfCBudW1iZXIpW10sIGZhbGxiYWNrPzogYW55KTogYW55IHtcbiAgY29uc3QgbGFzdCA9IHBhdGgubGVuZ3RoIC0gMVxuXG4gIGlmIChsYXN0IDwgMCkgcmV0dXJuIG9iaiA9PT0gdW5kZWZpbmVkID8gZmFsbGJhY2sgOiBvYmpcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGxhc3Q7IGkrKykge1xuICAgIGlmIChvYmogPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGZhbGxiYWNrXG4gICAgfVxuICAgIG9iaiA9IG9ialtwYXRoW2ldXVxuICB9XG5cbiAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gZmFsbGJhY2tcblxuICByZXR1cm4gb2JqW3BhdGhbbGFzdF1dID09PSB1bmRlZmluZWQgPyBmYWxsYmFjayA6IG9ialtwYXRoW2xhc3RdXVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVlcEVxdWFsIChhOiBhbnksIGI6IGFueSk6IGJvb2xlYW4ge1xuICBpZiAoYSA9PT0gYikgcmV0dXJuIHRydWVcblxuICBpZiAoYSBpbnN0YW5jZW9mIERhdGUgJiYgYiBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAvLyBJZiB0aGUgdmFsdWVzIGFyZSBEYXRlLCB0aGV5IHdlcmUgY29udmVydCB0byB0aW1lc3RhbXAgd2l0aCBnZXRUaW1lIGFuZCBjb21wYXJlIGl0XG4gICAgaWYgKGEuZ2V0VGltZSgpICE9PSBiLmdldFRpbWUoKSkgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBpZiAoYSAhPT0gT2JqZWN0KGEpIHx8IGIgIT09IE9iamVjdChiKSkge1xuICAgIC8vIElmIHRoZSB2YWx1ZXMgYXJlbid0IG9iamVjdHMsIHRoZXkgd2VyZSBhbHJlYWR5IGNoZWNrZWQgZm9yIGVxdWFsaXR5XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICBjb25zdCBwcm9wcyA9IE9iamVjdC5rZXlzKGEpXG5cbiAgaWYgKHByb3BzLmxlbmd0aCAhPT0gT2JqZWN0LmtleXMoYikubGVuZ3RoKSB7XG4gICAgLy8gRGlmZmVyZW50IG51bWJlciBvZiBwcm9wcywgZG9uJ3QgYm90aGVyIHRvIGNoZWNrXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICByZXR1cm4gcHJvcHMuZXZlcnkocCA9PiBkZWVwRXF1YWwoYVtwXSwgYltwXSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRPYmplY3RWYWx1ZUJ5UGF0aCAob2JqOiBhbnksIHBhdGg6IHN0cmluZywgZmFsbGJhY2s/OiBhbnkpOiBhbnkge1xuICAvLyBjcmVkaXQ6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNjQ5MTQ2My9hY2Nlc3NpbmctbmVzdGVkLWphdmFzY3JpcHQtb2JqZWN0cy13aXRoLXN0cmluZy1rZXkjY29tbWVudDU1Mjc4NDEzXzY0OTE2MjFcbiAgaWYgKG9iaiA9PSBudWxsIHx8ICFwYXRoIHx8IHR5cGVvZiBwYXRoICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbGxiYWNrXG4gIGlmIChvYmpbcGF0aF0gIT09IHVuZGVmaW5lZCkgcmV0dXJuIG9ialtwYXRoXVxuICBwYXRoID0gcGF0aC5yZXBsYWNlKC9cXFsoXFx3KylcXF0vZywgJy4kMScpIC8vIGNvbnZlcnQgaW5kZXhlcyB0byBwcm9wZXJ0aWVzXG4gIHBhdGggPSBwYXRoLnJlcGxhY2UoL15cXC4vLCAnJykgLy8gc3RyaXAgYSBsZWFkaW5nIGRvdFxuICByZXR1cm4gZ2V0TmVzdGVkVmFsdWUob2JqLCBwYXRoLnNwbGl0KCcuJyksIGZhbGxiYWNrKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvcGVydHlGcm9tSXRlbSAoXG4gIGl0ZW06IG9iamVjdCxcbiAgcHJvcGVydHk6IFNlbGVjdEl0ZW1LZXksXG4gIGZhbGxiYWNrPzogYW55XG4pOiBhbnkge1xuICBpZiAocHJvcGVydHkgPT0gbnVsbCkgcmV0dXJuIGl0ZW0gPT09IHVuZGVmaW5lZCA/IGZhbGxiYWNrIDogaXRlbVxuXG4gIGlmIChpdGVtICE9PSBPYmplY3QoaXRlbSkpIHJldHVybiBmYWxsYmFjayA9PT0gdW5kZWZpbmVkID8gaXRlbSA6IGZhbGxiYWNrXG5cbiAgaWYgKHR5cGVvZiBwcm9wZXJ0eSA9PT0gJ3N0cmluZycpIHJldHVybiBnZXRPYmplY3RWYWx1ZUJ5UGF0aChpdGVtLCBwcm9wZXJ0eSwgZmFsbGJhY2spXG5cbiAgaWYgKEFycmF5LmlzQXJyYXkocHJvcGVydHkpKSByZXR1cm4gZ2V0TmVzdGVkVmFsdWUoaXRlbSwgcHJvcGVydHksIGZhbGxiYWNrKVxuXG4gIGlmICh0eXBlb2YgcHJvcGVydHkgIT09ICdmdW5jdGlvbicpIHJldHVybiBmYWxsYmFja1xuXG4gIGNvbnN0IHZhbHVlID0gcHJvcGVydHkoaXRlbSwgZmFsbGJhY2spXG5cbiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgPyBmYWxsYmFjayA6IHZhbHVlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSYW5nZSAobGVuZ3RoOiBudW1iZXIpOiBudW1iZXJbXSB7XG4gIHJldHVybiBBcnJheS5mcm9tKHsgbGVuZ3RoIH0sICh2LCBrKSA9PiBrKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0WkluZGV4IChlbD86IEVsZW1lbnQgfCBudWxsKTogbnVtYmVyIHtcbiAgaWYgKCFlbCB8fCBlbC5ub2RlVHlwZSAhPT0gTm9kZS5FTEVNRU5UX05PREUpIHJldHVybiAwXG5cbiAgY29uc3QgaW5kZXggPSArd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpLmdldFByb3BlcnR5VmFsdWUoJ3otaW5kZXgnKVxuXG4gIGlmICghaW5kZXgpIHJldHVybiBnZXRaSW5kZXgoZWwucGFyZW50Tm9kZSBhcyBFbGVtZW50KVxuICByZXR1cm4gaW5kZXhcbn1cblxuY29uc3QgdGFnc1RvUmVwbGFjZSA9IHtcbiAgJyYnOiAnJmFtcDsnLFxuICAnPCc6ICcmbHQ7JyxcbiAgJz4nOiAnJmd0OycsXG59IGFzIGFueVxuXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlSFRNTCAoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL1smPD5dL2csIHRhZyA9PiB0YWdzVG9SZXBsYWNlW3RhZ10gfHwgdGFnKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyT2JqZWN0T25LZXlzPFQsIEsgZXh0ZW5kcyBrZXlvZiBUPiAob2JqOiBULCBrZXlzOiBLW10pOiB7IFtOIGluIEtdOiBUW05dIH0ge1xuICBjb25zdCBmaWx0ZXJlZCA9IHt9IGFzIHsgW04gaW4gS106IFRbTl0gfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGtleSA9IGtleXNbaV1cbiAgICBpZiAodHlwZW9mIG9ialtrZXldICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgZmlsdGVyZWRba2V5XSA9IG9ialtrZXldXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZpbHRlcmVkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9Vbml0IChzdHI6IHN0cmluZyB8IG51bWJlciB8IG51bGwgfCB1bmRlZmluZWQsIHVuaXQgPSAncHgnKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgaWYgKHN0ciA9PSBudWxsIHx8IHN0ciA9PT0gJycpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH0gZWxzZSBpZiAoaXNOYU4oK3N0ciEpKSB7XG4gICAgcmV0dXJuIFN0cmluZyhzdHIpXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGAke051bWJlcihzdHIpfSR7dW5pdH1gXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGtlYmFiQ2FzZSAoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gKHN0ciB8fCAnJykucmVwbGFjZSgvKFthLXpdKShbQS1aXSkvZywgJyQxLSQyJykudG9Mb3dlckNhc2UoKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNPYmplY3QgKG9iajogYW55KTogb2JqIGlzIG9iamVjdCB7XG4gIHJldHVybiBvYmogIT09IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCdcbn1cblxuLy8gS2V5Ym9hcmRFdmVudC5rZXlDb2RlIGFsaWFzZXNcbmV4cG9ydCBjb25zdCBrZXlDb2RlcyA9IE9iamVjdC5mcmVlemUoe1xuICBlbnRlcjogMTMsXG4gIHRhYjogOSxcbiAgZGVsZXRlOiA0NixcbiAgZXNjOiAyNyxcbiAgc3BhY2U6IDMyLFxuICB1cDogMzgsXG4gIGRvd246IDQwLFxuICBsZWZ0OiAzNyxcbiAgcmlnaHQ6IDM5LFxuICBlbmQ6IDM1LFxuICBob21lOiAzNixcbiAgZGVsOiA0NixcbiAgYmFja3NwYWNlOiA4LFxuICBpbnNlcnQ6IDQ1LFxuICBwYWdldXA6IDMzLFxuICBwYWdlZG93bjogMzQsXG59KVxuXG4vLyBUaGlzIHJlbWFwcyBpbnRlcm5hbCBuYW1lcyBsaWtlICckY2FuY2VsJyBvciAnJHZ1ZXRpZnkuaWNvbnMuY2FuY2VsJ1xuLy8gdG8gdGhlIGN1cnJlbnQgbmFtZSBvciBjb21wb25lbnQgZm9yIHRoYXQgaWNvbi5cbmV4cG9ydCBmdW5jdGlvbiByZW1hcEludGVybmFsSWNvbiAodm06IFZ1ZSwgaWNvbk5hbWU6IHN0cmluZyk6IFZ1ZXRpZnlJY29uIHtcbiAgaWYgKCFpY29uTmFtZS5zdGFydHNXaXRoKCckJykpIHtcbiAgICByZXR1cm4gaWNvbk5hbWVcbiAgfVxuXG4gIC8vIEdldCB0aGUgdGFyZ2V0IGljb24gbmFtZVxuICBjb25zdCBpY29uUGF0aCA9IGAkdnVldGlmeS5pY29ucy52YWx1ZXMuJHtpY29uTmFtZS5zcGxpdCgnJCcpLnBvcCgpIS5zcGxpdCgnLicpLnBvcCgpfWBcblxuICAvLyBOb3cgbG9vayB1cCBpY29uIGluZGlyZWN0aW9uIG5hbWUsXG4gIC8vIGUuZy4gJyR2dWV0aWZ5Lmljb25zLnZhbHVlcy5jYW5jZWwnXG4gIHJldHVybiBnZXRPYmplY3RWYWx1ZUJ5UGF0aCh2bSwgaWNvblBhdGgsIGljb25OYW1lKVxufVxuXG5leHBvcnQgZnVuY3Rpb24ga2V5czxPPiAobzogTykge1xuICByZXR1cm4gT2JqZWN0LmtleXMobykgYXMgKGtleW9mIE8pW11cbn1cblxuLyoqXG4gKiBDYW1lbGl6ZSBhIGh5cGhlbi1kZWxpbWl0ZWQgc3RyaW5nLlxuICovXG5jb25zdCBjYW1lbGl6ZVJFID0gLy0oXFx3KS9nXG5leHBvcnQgY29uc3QgY2FtZWxpemUgPSAoc3RyOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoY2FtZWxpemVSRSwgKF8sIGMpID0+IGMgPyBjLnRvVXBwZXJDYXNlKCkgOiAnJylcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzZXQgZGlmZmVyZW5jZSBvZiBCIGFuZCBBLCBpLmUuIHRoZSBzZXQgb2YgZWxlbWVudHMgaW4gQiBidXQgbm90IGluIEFcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFycmF5RGlmZiAoYTogYW55W10sIGI6IGFueVtdKTogYW55W10ge1xuICBjb25zdCBkaWZmOiBhbnlbXSA9IFtdXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYi5sZW5ndGg7IGkrKykge1xuICAgIGlmIChhLmluZGV4T2YoYltpXSkgPCAwKSBkaWZmLnB1c2goYltpXSlcbiAgfVxuICByZXR1cm4gZGlmZlxufVxuXG4vKipcbiAqIE1ha2VzIHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzdHJpbmcgdXBwZXJjYXNlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cHBlckZpcnN0IChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdyb3VwSXRlbXM8VCBleHRlbmRzIGFueSA9IGFueT4gKFxuICBpdGVtczogVFtdLFxuICBncm91cEJ5OiBzdHJpbmdbXSxcbiAgZ3JvdXBEZXNjOiBib29sZWFuW11cbik6IEl0ZW1Hcm91cDxUPltdIHtcbiAgY29uc3Qga2V5ID0gZ3JvdXBCeVswXVxuICBjb25zdCBncm91cHM6IEl0ZW1Hcm91cDxUPltdID0gW11cbiAgbGV0IGN1cnJlbnQgPSBudWxsXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpdGVtID0gaXRlbXNbaV1cbiAgICBjb25zdCB2YWwgPSBnZXRPYmplY3RWYWx1ZUJ5UGF0aChpdGVtLCBrZXkpXG4gICAgaWYgKGN1cnJlbnQgIT09IHZhbCkge1xuICAgICAgY3VycmVudCA9IHZhbFxuICAgICAgZ3JvdXBzLnB1c2goe1xuICAgICAgICBuYW1lOiB2YWwsXG4gICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgIH0pXG4gICAgfVxuICAgIGdyb3Vwc1tncm91cHMubGVuZ3RoIC0gMV0uaXRlbXMucHVzaChpdGVtKVxuICB9XG4gIHJldHVybiBncm91cHNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBJbkFycmF5PFQ+ICh2OiBUIHwgVFtdIHwgbnVsbCB8IHVuZGVmaW5lZCk6IFRbXSB7IHJldHVybiB2ICE9IG51bGwgPyBBcnJheS5pc0FycmF5KHYpID8gdiA6IFt2XSA6IFtdIH1cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRJdGVtczxUIGV4dGVuZHMgYW55ID0gYW55PiAoXG4gIGl0ZW1zOiBUW10sXG4gIHNvcnRCeTogc3RyaW5nW10sXG4gIHNvcnREZXNjOiBib29sZWFuW10sXG4gIGxvY2FsZTogc3RyaW5nLFxuICBjdXN0b21Tb3J0ZXJzPzogUmVjb3JkPHN0cmluZywgRGF0YVRhYmxlQ29tcGFyZUZ1bmN0aW9uPFQ+PlxuKTogVFtdIHtcbiAgaWYgKHNvcnRCeSA9PT0gbnVsbCB8fCAhc29ydEJ5Lmxlbmd0aCkgcmV0dXJuIGl0ZW1zXG4gIGNvbnN0IHN0cmluZ0NvbGxhdG9yID0gbmV3IEludGwuQ29sbGF0b3IobG9jYWxlLCB7IHNlbnNpdGl2aXR5OiAnYWNjZW50JywgdXNhZ2U6ICdzb3J0JyB9KVxuXG4gIHJldHVybiBpdGVtcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3J0QnkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHNvcnRLZXkgPSBzb3J0QnlbaV1cblxuICAgICAgbGV0IHNvcnRBID0gZ2V0T2JqZWN0VmFsdWVCeVBhdGgoYSwgc29ydEtleSlcbiAgICAgIGxldCBzb3J0QiA9IGdldE9iamVjdFZhbHVlQnlQYXRoKGIsIHNvcnRLZXkpXG5cbiAgICAgIGlmIChzb3J0RGVzY1tpXSkge1xuICAgICAgICBbc29ydEEsIHNvcnRCXSA9IFtzb3J0Qiwgc29ydEFdXG4gICAgICB9XG5cbiAgICAgIGlmIChjdXN0b21Tb3J0ZXJzICYmIGN1c3RvbVNvcnRlcnNbc29ydEtleV0pIHtcbiAgICAgICAgY29uc3QgY3VzdG9tUmVzdWx0ID0gY3VzdG9tU29ydGVyc1tzb3J0S2V5XShzb3J0QSwgc29ydEIpXG5cbiAgICAgICAgaWYgKCFjdXN0b21SZXN1bHQpIGNvbnRpbnVlXG5cbiAgICAgICAgcmV0dXJuIGN1c3RvbVJlc3VsdFxuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBpZiBib3RoIGNhbm5vdCBiZSBldmFsdWF0ZWRcbiAgICAgIGlmIChzb3J0QSA9PT0gbnVsbCAmJiBzb3J0QiA9PT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICBbc29ydEEsIHNvcnRCXSA9IFtzb3J0QSwgc29ydEJdLm1hcChzID0+IChzIHx8ICcnKS50b1N0cmluZygpLnRvTG9jYWxlTG93ZXJDYXNlKCkpXG5cbiAgICAgIGlmIChzb3J0QSAhPT0gc29ydEIpIHtcbiAgICAgICAgaWYgKCFpc05hTihzb3J0QSkgJiYgIWlzTmFOKHNvcnRCKSkgcmV0dXJuIE51bWJlcihzb3J0QSkgLSBOdW1iZXIoc29ydEIpXG4gICAgICAgIHJldHVybiBzdHJpbmdDb2xsYXRvci5jb21wYXJlKHNvcnRBLCBzb3J0QilcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gMFxuICB9KVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdEZpbHRlciAodmFsdWU6IGFueSwgc2VhcmNoOiBzdHJpbmcgfCBudWxsLCBpdGVtOiBhbnkpIHtcbiAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiZcbiAgICBzZWFyY2ggIT0gbnVsbCAmJlxuICAgIHR5cGVvZiB2YWx1ZSAhPT0gJ2Jvb2xlYW4nICYmXG4gICAgdmFsdWUudG9TdHJpbmcoKS50b0xvY2FsZUxvd2VyQ2FzZSgpLmluZGV4T2Yoc2VhcmNoLnRvTG9jYWxlTG93ZXJDYXNlKCkpICE9PSAtMVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VhcmNoSXRlbXM8VCBleHRlbmRzIGFueSA9IGFueT4gKGl0ZW1zOiBUW10sIHNlYXJjaDogc3RyaW5nKTogVFtdIHtcbiAgaWYgKCFzZWFyY2gpIHJldHVybiBpdGVtc1xuICBzZWFyY2ggPSBzZWFyY2gudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpXG4gIGlmIChzZWFyY2gudHJpbSgpID09PSAnJykgcmV0dXJuIGl0ZW1zXG5cbiAgcmV0dXJuIGl0ZW1zLmZpbHRlcihpdGVtID0+IE9iamVjdC5rZXlzKGl0ZW0pLnNvbWUoa2V5ID0+IGRlZmF1bHRGaWx0ZXIoZ2V0T2JqZWN0VmFsdWVCeVBhdGgoaXRlbSwga2V5KSwgc2VhcmNoLCBpdGVtKSkpXG59XG5cbi8qKlxuICogUmV0dXJuczpcbiAqICAtICdub3JtYWwnIGZvciBvbGQgc3R5bGUgc2xvdHMgLSBgPHRlbXBsYXRlIHNsb3Q9XCJkZWZhdWx0XCI+YFxuICogIC0gJ3Njb3BlZCcgZm9yIG9sZCBzdHlsZSBzY29wZWQgc2xvdHMgKGA8dGVtcGxhdGUgc2xvdD1cImRlZmF1bHRcIiBzbG90LXNjb3BlPVwiZGF0YVwiPmApIG9yIGJvdW5kIHYtc2xvdCAoYCNkZWZhdWx0PVwiZGF0YVwiYClcbiAqICAtICd2LXNsb3QnIGZvciB1bmJvdW5kIHYtc2xvdCAoYCNkZWZhdWx0YCkgLSBvbmx5IGlmIHRoZSB0aGlyZCBwYXJhbSBpcyB0cnVlLCBvdGhlcndpc2UgY291bnRzIGFzIHNjb3BlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U2xvdFR5cGU8VCBleHRlbmRzIGJvb2xlYW4gPSBmYWxzZT4gKHZtOiBWdWUsIG5hbWU6IHN0cmluZywgc3BsaXQ/OiBUKTogKFQgZXh0ZW5kcyB0cnVlID8gJ3Ytc2xvdCcgOiBuZXZlcikgfCAnbm9ybWFsJyB8ICdzY29wZWQnIHwgdm9pZCB7XG4gIGlmICh2bS4kc2xvdHNbbmFtZV0gJiYgdm0uJHNjb3BlZFNsb3RzW25hbWVdICYmICh2bS4kc2NvcGVkU2xvdHNbbmFtZV0gYXMgYW55KS5uYW1lKSB7XG4gICAgcmV0dXJuIHNwbGl0ID8gJ3Ytc2xvdCcgYXMgYW55IDogJ3Njb3BlZCdcbiAgfVxuICBpZiAodm0uJHNsb3RzW25hbWVdKSByZXR1cm4gJ25vcm1hbCdcbiAgaWYgKHZtLiRzY29wZWRTbG90c1tuYW1lXSkgcmV0dXJuICdzY29wZWQnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZSAoZm46IEZ1bmN0aW9uLCBkZWxheTogbnVtYmVyKSB7XG4gIGxldCB0aW1lb3V0SWQgPSAwIGFzIGFueVxuICByZXR1cm4gKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZClcbiAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IGZuKC4uLmFyZ3MpLCBkZWxheSlcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJlZml4ZWRTY29wZWRTbG90cyAocHJlZml4OiBzdHJpbmcsIHNjb3BlZFNsb3RzOiBhbnkpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKHNjb3BlZFNsb3RzKS5maWx0ZXIoayA9PiBrLnN0YXJ0c1dpdGgocHJlZml4KSkucmVkdWNlKChvYmo6IGFueSwgazogc3RyaW5nKSA9PiB7XG4gICAgb2JqW2sucmVwbGFjZShwcmVmaXgsICcnKV0gPSBzY29wZWRTbG90c1trXVxuICAgIHJldHVybiBvYmpcbiAgfSwge30pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTbG90ICh2bTogVnVlLCBuYW1lID0gJ2RlZmF1bHQnLCBkYXRhPzogb2JqZWN0IHwgKCgpID0+IG9iamVjdCksIG9wdGlvbmFsID0gZmFsc2UpIHtcbiAgaWYgKHZtLiRzY29wZWRTbG90c1tuYW1lXSkge1xuICAgIHJldHVybiB2bS4kc2NvcGVkU2xvdHNbbmFtZV0hKGRhdGEgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IGRhdGEoKSA6IGRhdGEpXG4gIH0gZWxzZSBpZiAodm0uJHNsb3RzW25hbWVdICYmICghZGF0YSB8fCBvcHRpb25hbCkpIHtcbiAgICByZXR1cm4gdm0uJHNsb3RzW25hbWVdXG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xhbXAgKHZhbHVlOiBudW1iZXIsIG1pbiA9IDAsIG1heCA9IDEpIHtcbiAgcmV0dXJuIE1hdGgubWF4KG1pbiwgTWF0aC5taW4obWF4LCB2YWx1ZSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYWRFbmQgKHN0cjogc3RyaW5nLCBsZW5ndGg6IG51bWJlciwgY2hhciA9ICcwJykge1xuICByZXR1cm4gc3RyICsgY2hhci5yZXBlYXQoTWF0aC5tYXgoMCwgbGVuZ3RoIC0gc3RyLmxlbmd0aCkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaHVuayAoc3RyOiBzdHJpbmcsIHNpemUgPSAxKSB7XG4gIGNvbnN0IGNodW5rZWQ6IHN0cmluZ1tdID0gW11cbiAgbGV0IGluZGV4ID0gMFxuICB3aGlsZSAoaW5kZXggPCBzdHIubGVuZ3RoKSB7XG4gICAgY2h1bmtlZC5wdXNoKHN0ci5zdWJzdHIoaW5kZXgsIHNpemUpKVxuICAgIGluZGV4ICs9IHNpemVcbiAgfVxuICByZXR1cm4gY2h1bmtlZFxufVxuXG5leHBvcnQgZnVuY3Rpb24gaHVtYW5SZWFkYWJsZUZpbGVTaXplIChieXRlczogbnVtYmVyLCBiaW5hcnkgPSBmYWxzZSk6IHN0cmluZyB7XG4gIGNvbnN0IGJhc2UgPSBiaW5hcnkgPyAxMDI0IDogMTAwMFxuICBpZiAoYnl0ZXMgPCBiYXNlKSB7XG4gICAgcmV0dXJuIGAke2J5dGVzfSBCYFxuICB9XG5cbiAgY29uc3QgcHJlZml4ID0gYmluYXJ5ID8gWydLaScsICdNaScsICdHaSddIDogWydrJywgJ00nLCAnRyddXG4gIGxldCB1bml0ID0gLTFcbiAgd2hpbGUgKE1hdGguYWJzKGJ5dGVzKSA+PSBiYXNlICYmIHVuaXQgPCBwcmVmaXgubGVuZ3RoIC0gMSkge1xuICAgIGJ5dGVzIC89IGJhc2VcbiAgICArK3VuaXRcbiAgfVxuICByZXR1cm4gYCR7Ynl0ZXMudG9GaXhlZCgxKX0gJHtwcmVmaXhbdW5pdF19QmBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhbWVsaXplT2JqZWN0S2V5cyAob2JqOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbCB8IHVuZGVmaW5lZCkge1xuICBpZiAoIW9iaikgcmV0dXJuIHt9XG5cbiAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikucmVkdWNlKChvOiBhbnksIGtleTogc3RyaW5nKSA9PiB7XG4gICAgb1tjYW1lbGl6ZShrZXkpXSA9IG9ialtrZXldXG4gICAgcmV0dXJuIG9cbiAgfSwge30pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZURlZXAgKFxuICBzb3VyY2U6IERpY3Rpb25hcnk8YW55PiA9IHt9LFxuICB0YXJnZXQ6IERpY3Rpb25hcnk8YW55PiA9IHt9XG4pIHtcbiAgZm9yIChjb25zdCBrZXkgaW4gdGFyZ2V0KSB7XG4gICAgY29uc3Qgc291cmNlUHJvcGVydHkgPSBzb3VyY2Vba2V5XVxuICAgIGNvbnN0IHRhcmdldFByb3BlcnR5ID0gdGFyZ2V0W2tleV1cblxuICAgIC8vIE9ubHkgY29udGludWUgZGVlcCBtZXJnaW5nIGlmXG4gICAgLy8gYm90aCBwcm9wZXJ0aWVzIGFyZSBvYmplY3RzXG4gICAgaWYgKFxuICAgICAgaXNPYmplY3Qoc291cmNlUHJvcGVydHkpICYmXG4gICAgICBpc09iamVjdCh0YXJnZXRQcm9wZXJ0eSlcbiAgICApIHtcbiAgICAgIHNvdXJjZVtrZXldID0gbWVyZ2VEZWVwKHNvdXJjZVByb3BlcnR5LCB0YXJnZXRQcm9wZXJ0eSlcblxuICAgICAgY29udGludWVcbiAgICB9XG5cbiAgICBzb3VyY2Vba2V5XSA9IHRhcmdldFByb3BlcnR5XG4gIH1cblxuICByZXR1cm4gc291cmNlXG59XG4iXX0=