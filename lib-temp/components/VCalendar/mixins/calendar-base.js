// Mixins
import mixins from '../../../util/mixins';
import Colorable from '../../../mixins/colorable';
import Localable from '../../../mixins/localable';
import Mouse from './mouse';
import Themeable from '../../../mixins/themeable';
import Times from './times';
// Directives
import Resize from '../../../directives/resize';
// Util
import props from '../util/props';
import { parseTimestamp, getWeekdaySkips, createDayList, createNativeLocaleFormatter, getStartOfWeek, getEndOfWeek, getTimestampIdentifier, } from '../util/timestamp';
export default mixins(Colorable, Localable, Mouse, Themeable, Times
/* @vue/component */
).extend({
    name: 'calendar-base',
    directives: {
        Resize,
    },
    props: props.base,
    computed: {
        parsedWeekdays() {
            return Array.isArray(this.weekdays)
                ? this.weekdays
                : (this.weekdays || '').split(',').map(x => parseInt(x, 10));
        },
        weekdaySkips() {
            return getWeekdaySkips(this.parsedWeekdays);
        },
        weekdaySkipsReverse() {
            const reversed = this.weekdaySkips.slice();
            reversed.reverse();
            return reversed;
        },
        parsedStart() {
            return parseTimestamp(this.start, true);
        },
        parsedEnd() {
            const start = this.parsedStart;
            const end = this.end ? parseTimestamp(this.end) || start : start;
            return getTimestampIdentifier(end) < getTimestampIdentifier(start) ? start : end;
        },
        days() {
            return createDayList(this.parsedStart, this.parsedEnd, this.times.today, this.weekdaySkips);
        },
        dayFormatter() {
            if (this.dayFormat) {
                return this.dayFormat;
            }
            const options = { timeZone: 'UTC', day: 'numeric' };
            return createNativeLocaleFormatter(this.currentLocale, (_tms, _short) => options);
        },
        weekdayFormatter() {
            if (this.weekdayFormat) {
                return this.weekdayFormat;
            }
            const longOptions = { timeZone: 'UTC', weekday: 'long' };
            const shortOptions = { timeZone: 'UTC', weekday: 'short' };
            return createNativeLocaleFormatter(this.currentLocale, (_tms, short) => short ? shortOptions : longOptions);
        },
    },
    methods: {
        getRelativeClasses(timestamp, outside = false) {
            return {
                'v-present': timestamp.present,
                'v-past': timestamp.past,
                'v-future': timestamp.future,
                'v-outside': outside,
            };
        },
        getStartOfWeek(timestamp) {
            return getStartOfWeek(timestamp, this.parsedWeekdays, this.times.today);
        },
        getEndOfWeek(timestamp) {
            return getEndOfWeek(timestamp, this.parsedWeekdays, this.times.today);
        },
        getFormatter(options) {
            return createNativeLocaleFormatter(this.locale, (_tms, _short) => options);
        },
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsZW5kYXItYmFzZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1ZDYWxlbmRhci9taXhpbnMvY2FsZW5kYXItYmFzZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxTQUFTO0FBQ1QsT0FBTyxNQUFNLE1BQU0sc0JBQXNCLENBQUE7QUFDekMsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxTQUFTLE1BQU0sMkJBQTJCLENBQUE7QUFDakQsT0FBTyxLQUFLLE1BQU0sU0FBUyxDQUFBO0FBQzNCLE9BQU8sU0FBUyxNQUFNLDJCQUEyQixDQUFBO0FBQ2pELE9BQU8sS0FBSyxNQUFNLFNBQVMsQ0FBQTtBQUUzQixhQUFhO0FBQ2IsT0FBTyxNQUFNLE1BQU0sNEJBQTRCLENBQUE7QUFFL0MsT0FBTztBQUNQLE9BQU8sS0FBSyxNQUFNLGVBQWUsQ0FBQTtBQUNqQyxPQUFPLEVBQ0wsY0FBYyxFQUNkLGVBQWUsRUFDZixhQUFhLEVBQ2IsMkJBQTJCLEVBQzNCLGNBQWMsRUFDZCxZQUFZLEVBQ1osc0JBQXNCLEdBQ3ZCLE1BQU0sbUJBQW1CLENBQUE7QUFHMUIsZUFBZSxNQUFNLENBQ25CLFNBQVMsRUFDVCxTQUFTLEVBQ1QsS0FBSyxFQUNMLFNBQVMsRUFDVCxLQUFLO0FBQ1Asb0JBQW9CO0NBQ25CLENBQUMsTUFBTSxDQUFDO0lBQ1AsSUFBSSxFQUFFLGVBQWU7SUFFckIsVUFBVSxFQUFFO1FBQ1YsTUFBTTtLQUNQO0lBRUQsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJO0lBRWpCLFFBQVEsRUFBRTtRQUNSLGNBQWM7WUFDWixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztnQkFDakMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRO2dCQUNmLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUMsS0FBSyxD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SUFBSSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFBO1FBQ3ZFLENBQUM7UUFDRCxZQUFZLENBQUUsT0FBZTtZQUMzQixPQUFPLDJCQUEyQixDQUNoQyxJQUFJLENBQUMsTUFBTSxFQUNYLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxFQUFFLENBQUMsT0FBTyxDQUMxQixDQUFBO1FBQ0gsQ0FBQztLQUNGO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiXG4vLyBNaXhpbnNcbmltcG9ydCBtaXhpbnMgZnJvbSAnLi4vLi4vLi4vdXRpbC9taXhpbnMnXG5pbXBvcnQgQ29sb3JhYmxlIGZyb20gJy4uLy4uLy4uL21peGlucy9jb2xvcmFibGUnXG5pbXBvcnQgTG9jYWxhYmxlIGZyb20gJy4uLy4uLy4uL21peGlucy9sb2NhbGFibGUnXG5pbXBvcnQgTW91c2UgZnJvbSAnLi9tb3VzZSdcbmltcG9ydCBUaGVtZWFibGUgZnJvbSAnLi4vLi4vLi4vbWl4aW5zL3RoZW1lYWJsZSdcbmltcG9ydCBUaW1lcyBmcm9tICcuL3RpbWVzJ1xuXG4vLyBEaXJlY3RpdmVzXG5pbXBvcnQgUmVzaXplIGZyb20gJy4uLy4uLy4uL2RpcmVjdGl2ZXMvcmVzaXplJ1xuXG4vLyBVdGlsXG5pbXBvcnQgcHJvcHMgZnJvbSAnLi4vdXRpbC9wcm9wcydcbmltcG9ydCB7XG4gIHBhcnNlVGltZXN0YW1wLFxuICBnZXRXZWVrZGF5U2tpcHMsXG4gIGNyZWF0ZURheUxpc3QsXG4gIGNyZWF0ZU5hdGl2ZUxvY2FsZUZvcm1hdHRlcixcbiAgZ2V0U3RhcnRPZldlZWssXG4gIGdldEVuZE9mV2VlayxcbiAgZ2V0VGltZXN0YW1wSWRlbnRpZmllcixcbn0gZnJvbSAnLi4vdXRpbC90aW1lc3RhbXAnXG5pbXBvcnQgeyBDYWxlbmRhclRpbWVzdGFtcCwgQ2FsZW5kYXJGb3JtYXR0ZXIgfSBmcm9tICd0eXBlcydcblxuZXhwb3J0IGRlZmF1bHQgbWl4aW5zKFxuICBDb2xvcmFibGUsXG4gIExvY2FsYWJsZSxcbiAgTW91c2UsXG4gIFRoZW1lYWJsZSxcbiAgVGltZXNcbi8qIEB2dWUvY29tcG9uZW50ICovXG4pLmV4dGVuZCh7XG4gIG5hbWU6ICdjYWxlbmRhci1iYXNlJyxcblxuICBkaXJlY3RpdmVzOiB7XG4gICAgUmVzaXplLFxuICB9LFxuXG4gIHByb3BzOiBwcm9wcy5iYXNlLFxuXG4gIGNvbXB1dGVkOiB7XG4gICAgcGFyc2VkV2Vla2RheXMgKCk6IG51bWJlcltdIHtcbiAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRoaXMud2Vla2RheXMpXG4gICAgICAgID8gdGhpcy53ZWVrZGF5c1xuICAgICAgICA6ICh0aGlzLndlZWtkYXlzIHx8ICcnKS5zcGxpdCgnLCcpLm1hcCh4ID0+IHBhcnNlSW50KHgsIDEwKSlcbiAgICB9LFxuICAgIHdlZWtkYXlTa2lwcyAoKTogbnVtYmVyW10ge1xuICAgICAgcmV0dXJuIGdldFdlZWtkYXlTa2lwcyh0aGlzLnBhcnNlZFdlZWtkYXlzKVxuICAgIH0sXG4gICAgd2Vla2RheVNraXBzUmV2ZXJzZSAoKTogbnVtYmVyIFtdIHtcbiAgICAgIGNvbnN0IHJldmVyc2VkID0gdGhpcy53ZWVrZGF5U2tpcHMuc2xpY2UoKVxuICAgICAgcmV2ZXJzZWQucmV2ZXJzZSgpXG4gICAgICByZXR1cm4gcmV2ZXJzZWRcbiAgICB9LFxuICAgIHBhcnNlZFN0YXJ0ICgpOiBDYWxlbmRhclRpbWVzdGFtcCB7XG4gICAgICByZXR1cm4gcGFyc2VUaW1lc3RhbXAodGhpcy5zdGFydCwgdHJ1ZSlcbiAgICB9LFxuICAgIHBhcnNlZEVuZCAoKTogQ2FsZW5kYXJUaW1lc3RhbXAge1xuICAgICAgY29uc3Qgc3RhcnQgPSB0aGlzLnBhcnNlZFN0YXJ0XG4gICAgICBjb25zdCBlbmQ6IENhbGVuZGFyVGltZXN0YW1wID0gdGhpcy5lbmQgPyBwYXJzZVRpbWVzdGFtcCh0aGlzLmVuZCkgfHwgc3RhcnQgOiBzdGFydFxuXG4gICAgICByZXR1cm4gZ2V0VGltZXN0YW1wSWRlbnRpZmllcihlbmQpIDwgZ2V0VGltZXN0YW1wSWRlbnRpZmllcihzdGFydCkgPyBzdGFydCA6IGVuZFxuICAgIH0sXG4gICAgZGF5cyAoKTogQ2FsZW5kYXJUaW1lc3RhbXBbXSB7XG4gICAgICByZXR1cm4gY3JlYXRlRGF5TGlzdChcbiAgICAgICAgdGhpcy5wYXJzZWRTdGFydCxcbiAgICAgICAgdGhpcy5wYXJzZWRFbmQsXG4gICAgICAgIHRoaXMudGltZXMudG9kYXksXG4gICAgICAgIHRoaXMud2Vla2RheVNraXBzXG4gICAgICApXG4gICAgfSxcbiAgICBkYXlGb3JtYXR0ZXIgKCk6IENhbGVuZGFyRm9ybWF0dGVyIHtcbiAgICAgIGlmICh0aGlzLmRheUZvcm1hdCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYXlGb3JtYXQgYXMgQ2FsZW5kYXJGb3JtYXR0ZXJcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb3B0aW9ucyA9IHsgdGltZVpvbmU6ICdVVEMnLCBkYXk6ICdudW1lcmljJyB9XG5cbiAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVMb2NhbGVGb3JtYXR0ZXIoXG4gICAgICAgIHRoaXMuY3VycmVudExvY2FsZSxcbiAgICAgICAgKF90bXMsIF9zaG9ydCkgPT4gb3B0aW9uc1xuICAgICAgKVxuICAgIH0sXG4gICAgd2Vla2RheUZvcm1hdHRlciAoKTogQ2FsZW5kYXJGb3JtYXR0ZXIge1xuICAgICAgaWYgKHRoaXMud2Vla2RheUZvcm1hdCkge1xuICAgICAgICByZXR1cm4gdGhpcy53ZWVrZGF5Rm9ybWF0IGFzIENhbGVuZGFyRm9ybWF0dGVyXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGxvbmdPcHRpb25zID0geyB0aW1lWm9uZTogJ1VUQycsIHdlZWtkYXk6ICdsb25nJyB9XG4gICAgICBjb25zdCBzaG9ydE9wdGlvbnMgPSB7IHRpbWVab25lOiAnVVRDJywgd2Vla2RheTogJ3Nob3J0JyB9XG5cbiAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVMb2NhbGVGb3JtYXR0ZXIoXG4gICAgICAgIHRoaXMuY3VycmVudExvY2FsZSxcbiAgICAgICAgKF90bXMsIHNob3J0KSA9PiBzaG9ydCA/IHNob3J0T3B0aW9ucyA6IGxvbmdPcHRpb25zXG4gICAgICApXG4gICAgfSxcbiAgfSxcblxuICBtZXRob2RzOiB7XG4gICAgZ2V0UmVsYXRpdmVDbGFzc2VzICh0aW1lc3RhbXA6IENhbGVuZGFyVGltZXN0YW1wLCBvdXRzaWRlID0gZmFsc2UpOiBvYmplY3Qge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgJ3YtcHJlc2VudCc6IHRpbWVzdGFtcC5wcmVzZW50LFxuICAgICAgICAndi1wYXN0JzogdGltZXN0YW1wLnBhc3QsXG4gICAgICAgICd2LWZ1dHVyZSc6IHRpbWVzdGFtcC5mdXR1cmUsXG4gICAgICAgICd2LW91dHNpZGUnOiBvdXRzaWRlLFxuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0U3RhcnRPZldlZWsgKHRpbWVzdGFtcDogQ2FsZW5kYXJUaW1lc3RhbXApOiBDYWxlbmRhclRpbWVzdGFtcCB7XG4gICAgICByZXR1cm4gZ2V0U3RhcnRPZldlZWsodGltZXN0YW1wLCB0aGlzLnBhcnNlZFdlZWtkYXlzLCB0aGlzLnRpbWVzLnRvZGF5KVxuICAgIH0sXG4gICAgZ2V0RW5kT2ZXZWVrICh0aW1lc3RhbXA6IENhbGVuZGFyVGltZXN0YW1wKTogQ2FsZW5kYXJUaW1lc3RhbXAge1xuICAgICAgcmV0dXJuIGdldEVuZE9mV2Vlayh0aW1lc3RhbXAsIHRoaXMucGFyc2VkV2Vla2RheXMsIHRoaXMudGltZXMudG9kYXkpXG4gICAgfSxcbiAgICBnZXRGb3JtYXR0ZXIgKG9wdGlvbnM6IG9iamVjdCk6IENhbGVuZGFyRm9ybWF0dGVyIHtcbiAgICAgIHJldHVybiBjcmVhdGVOYXRpdmVMb2NhbGVGb3JtYXR0ZXIoXG4gICAgICAgIHRoaXMubG9jYWxlLFxuICAgICAgICAoX3RtcywgX3Nob3J0KSA9PiBvcHRpb25zXG4gICAgICApXG4gICAgfSxcbiAgfSxcbn0pXG4iXX0=