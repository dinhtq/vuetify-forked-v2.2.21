import mixins from '../../util/mixins';
import header from './mixins/header';
import { wrapInArray, convertToUnit } from '../../util/helpers';
export default mixins(header).extend({
    name: 'v-data-table-header-desktop',
    methods: {
        genGroupByToggle(header) {
            return this.$createElement('span', {
                on: {
                    click: (e) => {
                        e.stopPropagation();
                        this.$emit('group', header.value);
                    },
                },
            }, ['group']);
        },
        getAria(beingSorted, isDesc) {
            const $t = (key) => this.$vuetify.lang.t(`$vuetify.dataTable.ariaLabel.${key}`);
            let ariaSort = 'none';
            let ariaLabel = [
                $t('sortNone'),
                $t('activateAscending'),
            ];
            if (!beingSorted) {
                return { ariaSort, ariaLabel: ariaLabel.join(' ') };
            }
            if (isDesc) {
                ariaSort = 'descending';
                ariaLabel = [
                    $t('sortDescending'),
                    $t(this.options.mustSort ? 'activateAscending' : 'activateNone'),
                ];
            }
            else {
                ariaSort = 'ascending';
                ariaLabel = [
                    $t('sortAscending'),
                    $t('activateDescending'),
                ];
            }
            return { ariaSort, ariaLabel: ariaLabel.join(' ') };
        },
        genHeader(header) {
            const data = {
                attrs: {
                    role: 'columnheader',
                    scope: 'col',
                    'aria-label': header.text || '',
                },
                style: {
                    width: convertToUnit(header.width),
                    minWidth: convertToUnit(header.width),
                },
                class: [
                    `text-${header.align || 'start'}`,
                    ...wrapInArray(header.class),
                    header.divider && 'v-data-table__divider',
                ],
                on: {},
            };
            const children = [];
            if (header.value === 'data-table-select' && !this.singleSelect) {
                return this.$createElement('th', data, [this.genSelectAll()]);
            }
            children.push(this.$scopedSlots[header.value]
                ? this.$scopedSlots[header.value]({ header })
                : this.$createElement('span', [header.text]));
            if (!this.disableSort && (header.sortable || !header.hasOwnProperty('sortable'))) {
                data.on['click'] = () => this.$emit('sort', header.value);
                const sortIndex = this.options.sortBy.findIndex(k => k === header.value);
                const beingSorted = sortIndex >= 0;
                const isDesc = this.options.sortDesc[sortIndex];
                data.class.push('sortable');
                const { ariaLabel, ariaSort } = this.getAria(beingSorted, isDesc);
                data.attrs['aria-label'] += `${header.text ? ': ' : ''}${ariaLabel}`;
                data.attrs['aria-sort'] = ariaSort;
                if (beingSorted) {
                    data.class.push('active');
                    data.class.push(isDesc ? 'desc' : 'asc');
                }
                if (header.align === 'end')
                    children.unshift(this.genSortIcon());
                else
                    children.push(this.genSortIcon());
                if (this.options.multiSort && beingSorted) {
                    children.push(this.$createElement('span', { class: 'v-data-table-header__sort-badge' }, [String(sortIndex + 1)]));
                }
            }
            if (this.showGroupBy)
                children.push(this.genGroupByToggle(header));
            return this.$createElement('th', data, children);
        },
    },
    render() {
        return this.$createElement('thead', {
            staticClass: 'v-data-table-header',
        }, [
            this.$createElement('tr', this.headers.map(header => this.genHeader(header))),
        ]);
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVkRhdGFUYWJsZUhlYWRlckRlc2t0b3AuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9WRGF0YVRhYmxlL1ZEYXRhVGFibGVIZWFkZXJEZXNrdG9wLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sTUFBTSxNQUFNLG1CQUFtQixDQUFBO0FBQ3RDLE9BQU8sTUFBTSxNQUFNLGlCQUFpQixDQUFBO0FBQ3BDLE9BQU8sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLE1BQU0sb0JBQW9CLENBQUE7QUFHL0QsZUFBZSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDO0lBQ25DLElBQUksRUFBRSw2QkFBNkI7SUFFbkMsT0FBTyxFQUFFO1FBQ1AsZ0JBQWdCLENBQUUsTUFBdUI7WUFDdkMsT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRTtnQkFDakMsRUFBRSxFQUFFO29CQUNGLEtBQUssRUFBRSxDQUFDLENBQWEsRUFBRSxFQUFFO3dCQUN2QixDQUFDLENBQUMsZUFBZSxFQUFFLENBQUE7d0JBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQTtvQkFDbkMsQ0FBQztpQkFDRjthQUNGLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFBO1FBQ2YsQ0FBQztRQUNELE9BQU8sQ0FBRSxXQUFvQixFQUFFLE1BQWU7WUFDNUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxHQUFXLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxnQ0FBZ0MsR0FBRyxFQUFFLENBQUMsQ0FBQTtZQUV2RixJQUFJLFFBQVEsR0FBRyxNQUFNLENBQUE7WUFDckIsSUFBSSxTQUFTLEdBQUc7Z0JBQ2QsRUFBRSxDQUFDLFVBQVUsQ0FBQztnQkFDZCxFQUFFLENBQUMsbUJBQW1CLENBQUM7YUFDeEIsQ0FB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UUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQTtZQUVsRSxPQUFPLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQTtRQUNsRCxDQUFDO0tBQ0Y7SUFFRCxNQUFNO1FBQ0osT0FBTyxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRTtZQUNsQyxXQUFXLEVBQUUscUJBQXFCO1NBQ25DLEVBQUU7WUFDRCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztTQUM5RSxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSGVscGVyc1xuaW1wb3J0IHsgVk5vZGUsIFZOb2RlRGF0YSB9IGZyb20gJ3Z1ZSdcbmltcG9ydCBtaXhpbnMgZnJvbSAnLi4vLi4vdXRpbC9taXhpbnMnXG5pbXBvcnQgaGVhZGVyIGZyb20gJy4vbWl4aW5zL2hlYWRlcidcbmltcG9ydCB7IHdyYXBJbkFycmF5LCBjb252ZXJ0VG9Vbml0IH0gZnJvbSAnLi4vLi4vdXRpbC9oZWxwZXJzJ1xuaW1wb3J0IHsgRGF0YVRhYmxlSGVhZGVyIH0gZnJvbSAndHlwZXMnXG5cbmV4cG9ydCBkZWZhdWx0IG1peGlucyhoZWFkZXIpLmV4dGVuZCh7XG4gIG5hbWU6ICd2LWRhdGEtdGFibGUtaGVhZGVyLWRlc2t0b3AnLFxuXG4gIG1ldGhvZHM6IHtcbiAgICBnZW5Hcm91cEJ5VG9nZ2xlIChoZWFkZXI6IERhdGFUYWJsZUhlYWRlcikge1xuICAgICAgcmV0dXJuIHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgIG9uOiB7XG4gICAgICAgICAgY2xpY2s6IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpXG4gICAgICAgICAgICB0aGlzLiRlbWl0KCdncm91cCcsIGhlYWRlci52YWx1ZSlcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSwgWydncm91cCddKVxuICAgIH0sXG4gICAgZ2V0QXJpYSAoYmVpbmdTb3J0ZWQ6IGJvb2xlYW4sIGlzRGVzYzogYm9vbGVhbikge1xuICAgICAgY29uc3QgJHQgPSAoa2V5OiBzdHJpbmcpID0+IHRoaXMuJHZ1ZXRpZnkubGFuZy50KGAkdnVldGlmeS5kYXRhVGFibGUuYXJpYUxhYmVsLiR7a2V5fWApXG5cbiAgICAgIGxldCBhcmlhU29ydCA9ICdub25lJ1xuICAgICAgbGV0IGFyaWFMYWJlbCA9IFtcbiAgICAgICAgJHQoJ3NvcnROb25lJyksXG4gICAgICAgICR0KCdhY3RpdmF0ZUFzY2VuZGluZycpLFxuICAgICAgXVxuXG4gICAgICBpZiAoIWJlaW5nU29ydGVkKSB7XG4gICAgICAgIHJldHVybiB7IGFyaWFTb3J0LCBhcmlhTGFiZWw6IGFyaWFMYWJlbC5qb2luKCcgJykgfVxuICAgICAgfVxuXG4gICAgICBpZiAoaXNEZXNjKSB7XG4gICAgICAgIGFyaWFTb3J0ID0gJ2Rlc2NlbmRpbmcnXG4gICAgICAgIGFyaWFMYWJlbCA9IFtcbiAgICAgICAgICAkdCgnc29ydERlc2NlbmRpbmcnKSxcbiAgICAgICAgICAkdCh0aGlzLm9wdGlvbnMubXVzdFNvcnQgPyAnYWN0aXZhdGVBc2NlbmRpbmcnIDogJ2FjdGl2YXRlTm9uZScpLFxuICAgICAgICBdXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcmlhU29ydCA9ICdhc2NlbmRpbmcnXG4gICAgICAgIGFyaWFMYWJlbCA9IFtcbiAgICAgICAgICAkdCgnc29ydEFzY2VuZGluZycpLFxuICAgICAgICAgICR0KCdhY3RpdmF0ZURlc2NlbmRpbmcnKSxcbiAgICAgICAgXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4geyBhcmlhU29ydCwgYXJpYUxhYmVsOiBhcmlhTGFiZWwuam9pbignICcpIH1cbiAgICB9LFxuICAgIGdlbkhlYWRlciAoaGVhZGVyOiBEYXRhVGFibGVIZWFkZXIpIHtcbiAgICAgIGNvbnN0IGRhdGE6IFJlcXVpcmVkPFBpY2s8Vk5vZGVEYXRhLCAnYXR0cnMnIHwgJ29uJyB8ICdjbGFzcycgfCAnc3R5bGUnPj4gPSB7XG4gICAgICAgIGF0dHJzOiB7XG4gICAgICAgICAgcm9sZTogJ2NvbHVtbmhlYWRlcicsXG4gICAgICAgICAgc2NvcGU6ICdjb2wnLFxuICAgICAgICAgICdhcmlhLWxhYmVsJzogaGVhZGVyLnRleHQgfHwgJycsXG4gICAgICAgIH0sXG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgd2lkdGg6IGNvbnZlcnRUb1VuaXQoaGVhZGVyLndpZHRoKSxcbiAgICAgICAgICBtaW5XaWR0aDogY29udmVydFRvVW5pdChoZWFkZXIud2lkdGgpLFxuICAgICAgICB9LFxuICAgICAgICBjbGFzczogW1xuICAgICAgICAgIGB0ZXh0LSR7aGVhZGVyLmFsaWduIHx8ICdzdGFydCd9YCxcbiAgICAgICAgICAuLi53cmFwSW5BcnJheShoZWFkZXIuY2xhc3MpLFxuICAgICAgICAgIGhlYWRlci5kaXZpZGVyICYmICd2LWRhdGEtdGFibGVfX2RpdmlkZXInLFxuICAgICAgICBdLFxuICAgICAgICBvbjoge30sXG4gICAgICB9XG4gICAgICBjb25zdCBjaGlsZHJlbiA9IFtdXG5cbiAgICAgIGlmIChoZWFkZXIudmFsdWUgPT09ICdkYXRhLXRhYmxlLXNlbGVjdCcgJiYgIXRoaXMuc2luZ2xlU2VsZWN0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KCd0aCcsIGRhdGEsIFt0aGlzLmdlblNlbGVjdEFsbCgpXSlcbiAgICAgIH1cblxuICAgICAgY2hpbGRyZW4ucHVzaChcbiAgICAgICAgdGhpcy4kc2NvcGVkU2xvdHNbaGVhZGVyLnZhbHVlXVxuICAgICAgICAgID8gdGhpcy4kc2NvcGVkU2xvdHNbaGVhZGVyLnZhbHVlXSEoeyBoZWFkZXIgfSlcbiAgICAgICAgICA6IHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCBbaGVhZGVyLnRleHRdKVxuICAgICAgKVxuXG4gICAgICBpZiAoIXRoaXMuZGlzYWJsZVNvcnQgJiYgKGhlYWRlci5zb3J0YWJsZSB8fCAhaGVhZGVyLmhhc093blByb3BlcnR5KCdzb3J0YWJsZScpKSkge1xuICAgICAgICBkYXRhLm9uWydjbGljayddID0gKCkgPT4gdGhpcy4kZW1pdCgnc29ydCcsIGhlYWRlci52YWx1ZSlcblxuICAgICAgICBjb25zdCBzb3J0SW5kZXggPSB0aGlzLm9wdGlvbnMuc29ydEJ5LmZpbmRJbmRleChrID0+IGsgPT09IGhlYWRlci52YWx1ZSlcbiAgICAgICAgY29uc3QgYmVpbmdTb3J0ZWQgPSBzb3J0SW5kZXggPj0gMFxuICAgICAgICBjb25zdCBpc0Rlc2MgPSB0aGlzLm9wdGlvbnMuc29ydERlc2Nbc29ydEluZGV4XVxuXG4gICAgICAgIGRhdGEuY2xhc3MucHVzaCgnc29ydGFibGUnKVxuXG4gICAgICAgIGNvbnN0IHsgYXJpYUxhYmVsLCBhcmlhU29ydCB9ID0gdGhpcy5nZXRBcmlhKGJlaW5nU29ydGVkLCBpc0Rlc2MpXG5cbiAgICAgICAgZGF0YS5hdHRyc1snYXJpYS1sYWJlbCddICs9IGAke2hlYWRlci50ZXh0ID8gJzogJyA6ICcnfSR7YXJpYUxhYmVsfWBcbiAgICAgICAgZGF0YS5hdHRyc1snYXJpYS1zb3J0J10gPSBhcmlhU29ydFxuXG4gICAgICAgIGlmIChiZWluZ1NvcnRlZCkge1xuICAgICAgICAgIGRhdGEuY2xhc3MucHVzaCgnYWN0aXZlJylcbiAgICAgICAgICBkYXRhLmNsYXNzLnB1c2goaXNEZXNjID8gJ2Rlc2MnIDogJ2FzYycpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGVhZGVyLmFsaWduID09PSAnZW5kJykgY2hpbGRyZW4udW5zaGlmdCh0aGlzLmdlblNvcnRJY29uKCkpXG4gICAgICAgIGVsc2UgY2hpbGRyZW4ucHVzaCh0aGlzLmdlblNvcnRJY29uKCkpXG5cbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5tdWx0aVNvcnQgJiYgYmVpbmdTb3J0ZWQpIHtcbiAgICAgICAgICBjaGlsZHJlbi5wdXNoKHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzOiAndi1kYXRhLXRhYmxlLWhlYWRlcl9fc29ydC1iYWRnZScgfSwgW1N0cmluZyhzb3J0SW5kZXggKyAxKV0pKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnNob3dHcm91cEJ5KSBjaGlsZHJlbi5wdXNoKHRoaXMuZ2VuR3JvdXBCeVRvZ2dsZShoZWFkZXIpKVxuXG4gICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgndGgnLCBkYXRhLCBjaGlsZHJlbilcbiAgICB9LFxuICB9LFxuXG4gIHJlbmRlciAoKTogVk5vZGUge1xuICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KCd0aGVhZCcsIHtcbiAgICAgIHN0YXRpY0NsYXNzOiAndi1kYXRhLXRhYmxlLWhlYWRlcicsXG4gICAgfSwgW1xuICAgICAgdGhpcy4kY3JlYXRlRWxlbWVudCgndHInLCB0aGlzLmhlYWRlcnMubWFwKGhlYWRlciA9PiB0aGlzLmdlbkhlYWRlcihoZWFkZXIpKSksXG4gICAgXSlcbiAgfSxcbn0pXG4iXX0=